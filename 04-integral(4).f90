PROGRAM integral

!Autor: Álisson Matheus Araújo Silva
!Matrícula: 17/0135888
!Criado em: 24/06/2019

IMPLICIT NONE

!Valor de pi para comparação:
REAL*8 :: pi = 4.d0*datan(1.d0)

!Variáveis para quadratura do retângulo
REAL*8 :: f
REAL*8 :: xr
REAL*8 :: h
REAL*8 :: integral_r

!Variáveis para regra do trapézio e de Simpson:
INTEGER :: i
REAL*8 :: x0,x, xi, xp
REAL*8 :: fa, fb, fx, fxi, fxp
REAL*8 :: integral_t
REAL*8 :: si,sp,integral_s



!Variáveis para regra de Gauss:
REAL*8 :: s, s1, s2, s3
REAL*8 :: f21, f22, f31,f32,f33,f41,f42,f43,f44,f51,f52,f53,f54,f55,f61,f62,f63,f64,f65,f66
REAL*8 :: f71,f72,f73,f74,f75,f76,f77
REAL*8 :: ff81,f82,f83,f84,f85,f86,f87,f88
REAL*8 :: f91,f92,f93,f94,f95,f96,f97,f98,f99
REAL*8 :: f101,f102,f103,f104,f105,f106,f107,f108,f109, f1010
REAL*8 :: f121,f122,f123,f124,f125,f126,f127,f128,f129, f1210, f1211,f1212
REAL*8 :: f161,f162,f163,f164,f165,f166,f167,f168
REAL*8 :: f169,f1610,f1611,f1612,f1613,f1614,f1615,f1616
REAL*8 :: f201,f202,f203,f204,f205,f206,f207,f208,f209, f2010
REAL*8 :: f2011,f2012,f2013,f2014,f2015,f2016,f2017,f2018,f2019, f2020

!Raízes:
REAL*8 :: x21 = 0.577350269289626d0

REAL*8 :: x31 = 0d0
REAL*8 :: X32 = 0.77459669241483d0

REAL*8 :: x41 = 0.339981043584856d0
REAL*8 :: x42 = 0.861136311594053d0

REAL*8 :: x51 = 0d0
REAL*8 :: x52 = 0.538469310105683d0
REAL*8 :: x53 = 0.906179845938664d0


REAL*8 :: x61 = 0.238619186083197d0
REAL*8 :: x62 = 0.661209386466265d0
REAL*8 :: x63 = 0.932469514203152d0

REAL*8 :: x71 = 0d0
REAL*8 :: x72 = 0.405845151377397d0
REAL*8 :: x73 = 0.741531185599394d0
REAL*8 :: x74 = 0.949107912342759d0

REAL*8 :: x81 = 0.183434642495650d0
REAL*8 :: x82 = 0.525532409916329d0
REAL*8 :: x83 = 0.796666477413627d0
REAL*8 :: x84 = 0.960289856497536d0

REAL*8 :: x91 = 0d0
REAL*8 :: x92 = 0.324253423403809d0
REAL*8 :: x93 = 0.613371432700590d0
REAL*8 :: x94 = 0.836031107326636d0
REAL*8 :: x95 = 0.968160239507626d0

REAL*8 :: x101= 0.148874338981631d0
REAL*8 :: x102= 0.433395394129247d0
REAL*8 :: x103= 0.679409568299024d0
REAL*8 :: x104= 0.865063366688985d0
REAL*8 :: x105= 0.973906528517172d0

REAL*8 :: x121 = 0.125233408511469d0
REAL*8 :: x122 = 0.367831498998180d0
REAL*8 :: x123 = 0.587317954286617d0
REAL*8 :: x124 = 0.769902674194305d0
REAL*8 :: x125 = 0.904117256370475d0
REAL*8 :: x126 = 0.981560634246719d0

REAL*8 :: x161 = 0.095012509837637440185d0
REAL*8 :: x162 = 0.281603550779258913230d0
REAL*8 :: x163 = 0.458016777657227386342d0
REAL*8 :: x164 = 0.617876244402643748447d0
REAL*8 :: x165 = 0.755404408355003033895d0
REAL*8 :: x166 = 0.865631202387831743880d0
REAL*8 :: x167 = 0.944575023073232576078d0
REAL*8 :: x168 = 0.989400934991649932596d0

REAL*8 :: x201 = 0.076526521133497333755d0
REAL*8 :: x202 = 0.227785851141645078080d0
REAL*8 :: x203 = 0.373706088715419560673d0
REAL*8 :: x204 = 0.510867001950827098004d0
REAL*8 :: x205 = 0.636053680726515025453d0
REAL*8 :: x206 = 0.746331906460150792614d0
REAL*8 :: x207 = 0.839116971822218823395d0
REAL*8 :: x208 = 0.912234428251325905868d0
REAL*8 :: x209 = 0.963971927277913791268d0
REAL*8 :: x2010= 0.993128599185094924786d0


!coeficientes:
REAL*8 :: w21 = 1d0
REAL*8 :: w22 = 1d0

REAL*8 :: w31 = 0.888888888888889d0
REAL*8 :: w32 = 0.555555555555556d0

REAL*8 :: w41 = 0.652145154862546d0
REAL*8 :: w42 = 0.347854845137454d0

REAL*8 :: w51 = 0.568888888888889d0
REAL*8 :: w52 = 0.478628670499366d0
REAL*8 :: w53 = 0.236926885056189d0

REAL*8 :: w61 = 0.467913934572691d0
REAL*8 :: w62 = 0.360761573048139d0
REAL*8 :: w63 = 0.171324492379170d0

REAL*8 :: w71 = 0.417959183673469d0
REAL*8 :: w72 = 0.381830050505119d0
REAL*8 :: w73 = 0.279705391489277d0
REAL*8 :: w74 = 0.129484966168870d0

REAL*8 :: w81 = 0.362683783378362d0
REAL*8 :: w82 = 0.313706645877887d0
REAL*8 :: w83 = 0.222381034453374d0
REAL*8 :: w84 = 0.101228536290376d0

REAL*8 :: w91 = 0.330239355001260d0
REAL*8 :: w92 = 0.312347077040003d0
REAL*8 :: w93 = 0.260610696402935d0
REAL*8 :: w94 = 0.180648160694857d0
REAL*8 :: w95 = 0.081274388361574d0

REAL*8 :: w101= 0.295524224714753d0
REAL*8 :: w102= 0.269266719309996d0
REAL*8 :: w103= 0.219086362515982d0
REAL*8 :: w104= 0.149451349150581d0
REAL*8 :: w105= 0.066671344308688d0

REAL*8 :: w121= 0.249147045813403d0
REAL*8 :: w122= 0.233492536538355d0
REAL*8 :: w123= 0.203167426723066d0
REAL*8 :: w124= 0.160078328543346d0
REAL*8 :: w125= 0.106939325995318d0
REAL*8 :: w126= 0.047175336386512d0

REAL*8 :: w161= 0.189450610455068496285d0
REAL*8 :: w162= 0.182603415044923588867d0
REAL*8 :: w163= 0.169156519395002538189d0
REAL*8 :: w164= 0.149595988816576732081d0
REAL*8 :: w165= 0.124628971255533872052d0
REAL*8 :: w166= 0.095158511682492784810d0
REAL*8 :: w167= 0.062253523938647892863d0
REAL*8 :: w168= 0.027152459411754094852d0

REAL*8 :: w201= 0.152753387130725850698d0
REAL*8 :: w202= 0.149172986472603746788d0
REAL*8 :: w203= 0.142096109318382051329d0
REAL*8 :: w204= 0.131688638449176626898d0
REAL*8 :: w205= 0.118194531961518417312d0
REAL*8 :: w206= 0.101930119817240435037d0
REAL*8 :: w207= 0.083276741576704748725d0
REAL*8 :: w208= 0.062672048334109063570d0
REAL*8 :: w209= 0.040601429800386941331d0
REAL*8 :: w2010=0.017614007139152118312d0


REAL*8 :: intervalo !tamanho do intervalo
integer :: n      !nº de subintervalos

WRITE(*,*)"====================================================================================================================="
WRITE(*,*)"  METODO:          SUB INTERVALOS: 			PONTOS:               APROXIMACAO:				ERRO:"
WRITE(*,*)"====================================================================================================================="

x0 = -1
intervalo = 2
n = 30000
h = intervalo/n
fa = sqrt(1-(x0)**(2))
fb = sqrt(1-(x0+intervalo)**(2))

!Método do retângulo:
xr = -1 + h/2d0
integral_r = 0

DO i = 1,n-1

f = sqrt(1-((xr)**(2)))
integral_r = integral_r + f

xr = xr + h

END DO 
integral_r = integral_r*h

WRITE(*,*) "  Retangulo		 30000		 		30001  		   ",integral_r, abs(pi/2 - integral_r)
WRITE(*,*) "---------------------------------------------------------------------------------------------------------------------"

!Regra do trapézio:
integral_t = 0


do i = 1, n-2
  x = i*h + x0
  fx = sqrt(1-(x)**(2))
  integral_t = integral_t + fx
end do

!Soma dos termos com os pontos avaliados nos extremos
integral_t = (fa + fb + integral_t*2)*h/2


WRITE(*,*) "  Trapezio		 30000		 		30001  		   ",integral_t, abs(pi/2 - integral_t)




WRITE(*,*) "---------------------------------------------------------------------------------------------------------------------"
!Regra de Simpson

si = 0
sp = 0

!Soma dos termos impares

do i = 1, n-1, 2   !Os termos da soma são selecionados de 2 em 2

xi = i*h + x0 
fxi = sqrt(1-(xi)**(2))


  si = si + fxi


end do


if (n>2) then

!Soma dos termos pares
do i = 2, n-2,2
  
xp = i*h + x0 
 
fxp = sqrt(1-(xp)**(2))
  sp = sp + fxp

end do
end if

!Soma de todos os termos com os pontos avaliados nos extremos
integral_s = 0
integral_s = (fa + fb + 4*si + 2*sp)*h/3


WRITE(*,*) "  Simpson		 30000		 		30001  		   ",integral_s, abs(pi/2 - integral_s)

WRITE(*,*) "---------------------------------------------------------------------------------------------------------------------"

!Método de Gauss

!2 pontos
f21 = sqrt(1-(x21)**2)
f22 = sqrt(1-(-x21)**2)
s = f21*w21 + f22*w22
WRITE(*,*) "  Gauss		   02 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!3 pontos
f31 = sqrt(1-(x31)**2)
f32 = sqrt(1-(x32)**2)
f33 = sqrt(1-(-x32)**2)
s = f31*w31 + f32*w32 + f33*w32

WRITE(*,*) "  Gauss		   03 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!4 pontos

f41 = sqrt(1-(x41)**2)
f42 = sqrt(1-(-x41)**2)
f43 = sqrt(1-(x42)**2)
f44 = sqrt(1-(-x42)**2)

s = f41*w41 + f42*w41 + f43*w42 + f44*w42
WRITE(*,*) "  Gauss		   04 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!5 pontos

f51 = sqrt(1-(x51)**2)
f52 = sqrt(1-(x52)**2)
f53 = sqrt(1-(-x52)**2)
f54 = sqrt(1-(x53)**2)
f55 = sqrt(1-(-x53)**2)

s = f51*w51 + f52*w52 + f53*w52 + f54*w53 + f55*w53
WRITE(*,*) "  Gauss		   05 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!6 pontos

f61 = sqrt(1-(x61)**2)
f62 = sqrt(1-(-x61)**2)
f63 = sqrt(1-(x62)**2)
f64 = sqrt(1-(-x62)**2)
f65 = sqrt(1-(x63)**2)
f66 = sqrt(1-(-x63)**2)

s = f61*w61+f62*w61+f63*w62+f64*w62+f65*w63+f66*w63
WRITE(*,*) "  Gauss		   06 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!7 pontos

f71 = sqrt(1-(x71)**2)
f72 = sqrt(1-(x72)**2)
f73 = sqrt(1-(-x72)**2)
f74 = sqrt(1-(x73)**2)
f75 = sqrt(1-(-x73)**2)
f76 = sqrt(1-(x74)**2)
f77 = sqrt(1-(-x74)**2)

s = f71*w71+f72*w72+f73*w72+f74*w73+f75*w73+f76*w74+f77*w74
WRITE(*,*) "  Gauss		   07 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!8 pontos

ff81 = sqrt(1-(x81)**2)
f82 = sqrt(1-(-x81)**2)
f83 = sqrt(1-(x82)**2)
f84 = sqrt(1-(-x82)**2)
f85 = sqrt(1-(x83)**2)
f86 = sqrt(1-(-x83)**2)
f87 = sqrt(1-(x84)**2)
f88 = sqrt(1-(-x84)**2)

s = ff81*w81 + f82*w81 + f83*w82 + f84*w82 + f85*w83 + f86*w83 + f87*w84 + f88*w84
WRITE(*,*) "  Gauss		   08 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!9 pontos

f91 = sqrt(1-(x91)**2)
f92 = sqrt(1-(x92)**2)
f93 = sqrt(1-(-x92)**2)
f94 = sqrt(1-(x93)**2)
f95 = sqrt(1-(-x93)**2)
f96 = sqrt(1-(x94)**2)
f97 = sqrt(1-(-x94)**2)
f98 = sqrt(1-(x95)**2)
f99 = sqrt(1-(-x95)**2)

s = f91*w91 + f92*w92 + f93*w92 + f94*w93 + f95*w93 + f96*w94 + f97*w94 + f98*w95 + f99*w95
WRITE(*,*) "  Gauss		   09 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!10 pontos

f101 = sqrt(1-(x101)**2)
f102 = sqrt(1-(-x101)**2)
f103 = sqrt(1-(x102)**2)
f104 = sqrt(1-(-x102)**2)
f105 = sqrt(1-(x103)**2)
f106 = sqrt(1-(-x103)**2)
f107 = sqrt(1-(x104)**2)
f108 = sqrt(1-(-x104)**2)
f109 = sqrt(1-(x105)**2)
f1010 = sqrt(1-(-x105)**2)


s = f101*w101 + f102*w101 + f103*w102 + f104*w102 + f105*w103 + f106*w103 + f107*w104 + f108*w104 + f109*w105 + f1010*w105
WRITE(*,*) "  Gauss		   10 			",s, abs(pi/2 - s)
WRITE(*,*) "--------------------------------------------------------------------"
!12 pontos

f121 = sqrt(1-(x121)**2)
f122 = sqrt(1-(-x121)**2)
f123 = sqrt(1-(x122)**2)
f124 = sqrt(1-(-x122)**2)
f125 = sqrt(1-(x123)**2)
f126 = sqrt(1-(-x123)**2)
f127 = sqrt(1-(x124)**2)
f128 = sqrt(1-(-x124)**2)
f129 = sqrt(1-(x125)**2)
f1210 = sqrt(1-(-x125)**2)
f1211 = sqrt(1-(x126)**2)
f1212 = sqrt(1-(-x126)**2)

s1 = f121*w121 + f122*w121 + f123*w122 + f124*w122 + f125*w123 + f126*w123
s2 = f127*w124 + f128*w124 + f129*w125 + f1210*w125 + f1211*w126 + f1212*w126
WRITE(*,*) "  Gauss		   12 			",s1+s2, abs(pi/2 - (s1+s2))
WRITE(*,*) "--------------------------------------------------------------------"

!16 pontos

f161 = sqrt(1-(x161)**2)
f162 = sqrt(1-(-x161)**2)
f163 = sqrt(1-(x162)**2)
f164 = sqrt(1-(-x162)**2)
f165 = sqrt(1-(x163)**2)
f166 = sqrt(1-(-x163)**2)
f167 = sqrt(1-(x164)**2)
f168 = sqrt(1-(-x164)**2)
f169 = sqrt(1-(x165)**2)
f1610 = sqrt(1-(-x165)**2)
f1611 = sqrt(1-(x166)**2)
f1612 = sqrt(1-(-x166)**2)
f1613 = sqrt(1-(x167)**2)
f1614 = sqrt(1-(-x167)**2)
f1615 = sqrt(1-(x168)**2)
f1616 = sqrt(1-(-x168)**2)




s1 = f161*w161 + f162*w161 + f163*w162 + f164*w162 + f165*w163 + f166*w163 + f167*w164 + f168*w164
s2 = f169*w165 + f1610*w165 + f1611*w166 + f1612*w166 + f1613*w167 + f1614*w167 + f1615*w168 + f1616*w168
WRITE(*,*) "  Gauss		   16 			",s1+s2, abs(pi/2 - (s1+s2))
WRITE(*,*) "--------------------------------------------------------------------"
!20 pontos

f201 = sqrt(1-(x201)**2)
f202 = sqrt(1-(-x201)**2)
f203 = sqrt(1-(x202)**2)
f204 = sqrt(1-(-x202)**2)
f205 = sqrt(1-(x203)**2)
f206 = sqrt(1-(-x203)**2)
f207 = sqrt(1-(x204)**2)
f208 = sqrt(1-(-x204)**2)
f209 = sqrt(1-(x205)**2)
f2010 = sqrt(1-(-x205)**2)
f2011 = sqrt(1-(x206)**2)
f2012 = sqrt(1-(-x206)**2)
f2013 = sqrt(1-(x207)**2)
f2014 = sqrt(1-(-x207)**2)
f2015 = sqrt(1-(x208)**2)
f2016 = sqrt(1-(-x208)**2)
f2017 = sqrt(1-(x209)**2)
f2018 = sqrt(1-(-x209)**2)
f2019 = sqrt(1-(x2010)**2)
f2020 = sqrt(1-(-x2010)**2)


s1 = f201*w201 + f202*w201 + f203*w202 + f204*w202 + f205*w203 + f206*w203 + f207*w204 + f208*w204 + f209*w205 + f2010*w205
s2 = f2011*w206 + f2012*w206 + f2013*w207 + f2014*w207 + f2015*w208 + f2016*w208 + f2017*w209 + f2018*w209 + f2019*w2010 
s3 = f2020*w2010
WRITE(*,*) "  Gauss		   20 			",s1+s2+s3, abs(pi/2 - (s1+s2+s3))




WRITE(*,*) "--------------------------------------------------------------------"





END PROGRAM
